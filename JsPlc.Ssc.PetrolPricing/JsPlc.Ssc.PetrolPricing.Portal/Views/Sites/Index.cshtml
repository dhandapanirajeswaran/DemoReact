@model IEnumerable<JsPlc.Ssc.PetrolPricing.Models.Site>
@{
    ViewBag.Title = "Sainsbury's sites";

    var activeSiteCount = 0;
    var inactiveSiteCount = 0;
    var totalSiteCount = 0;
    var trialPriceSiteCount = 0;
    var matchCompetitorSiteCount = 0;
    var siloSiteCount = 0;

    if (Model != null)
    {
        foreach (var site in Model)
        {
            if (site.IsActive)
            {
                activeSiteCount++;
            }
            else
            {
                inactiveSiteCount++;
            }

            if (site.TrailPriceCompetitorId.HasValue)
            {
                matchCompetitorSiteCount++;
            }
            else if (site.CompetitorPriceOffset != 0)
            {
                trialPriceSiteCount++;
            }
            else
            {
                siloSiteCount++;
            }

            totalSiteCount++;
        }
    }
}


<style>
    .match-competitor-price,
    .trial-price,
    .none-price {
        color: #ccc;
    }

    .highlight-match-competitors .match-competitor-price {
        background-color: #cff;
        color: #000;
    }

    .highlight-trial-prices .trial-price {
        background-color: #ff8;
        color: #000;
    }

    .highlight-none-prices .none-price {
        background-color: #cfc;
        color: #000;
    }
</style>

<div class="row">
    <div class="col-md-6">
        <h1><i class="fa fa-gear"></i> Sainsbury's sites</h1>
    </div>
    <div class="col-md-6 text-right" style="padding-top: 20px">
        <button type="button" onclick="location.href='@Url.Action("Create", "Sites" )'" class="btn btn-primary"><i class="fa fa-star"></i> New Sainsbury's site</button>
    </div>
</div>

<div style="display:none;" class="alert alert-warning busy-loader" data-bind="visible: $root.busyLoadingData()">
    <div class="col-md-1 text-center">
        <i class="fa fa-clock-o fa-2x spinner"></i>
    </div>
    <div class="col-md-10 text-center">
        <strong>Loading Site Maintenance information. Please wait...</strong>
    </div>
    <div class="clearfix"></div>
</div>

<div class="alert alert-info @(string.IsNullOrWhiteSpace(ViewBag.Message) ? "hidden" : "")">@ViewBag.Message</div>
<!-- Approx 300 Sainsbury's sites -->
<hr />
<div class="row">

    <!-- Catalist No -->
    <div class="col-md-2">
        <label for="viewingCatNo">Catalist no:</label>
        <input type="text" id="viewingCatNo" class="form-control"
               name="viewingCatNo" maxlength="9" data-bind="numeric, value: $root.CatNo" />
    </div>
    <!-- Store No -->
    <div class="col-md-2">
        <label for="viewingStoreNo">Store no:</label>
        <input type="text" id="viewingStoreNo" class="form-control"
               name="viewingStoreNo" maxlength="9" data-bind="numeric, value: $root.StoreNo" />
    </div>

    <!-- Store Name -->
    <div class="col-md-2">
        <label for="viewingStoreName">Store name:</label>
        <input type="text" id="viewingStoreName" class="form-control" maxlength="50"
               name="viewingStoreName" data-bind="value: $root.StoreName" />
    </div>
    <!-- Store Town -->
    <div class="col-md-2">
        <label for="viewingStoreTown">Town:</label>
        <input type="text" id="viewingStoreTown" class="form-control" maxlength="50"
               name="viewingStoreTown" data-bind="value: $root.StoreTown" />
    </div>

    <div class="col-md-1">
        <button style="margin-top: 24px" type="button" id="btnGO" class="btn btn-success" data-bind="click: searchSainsburysStores">Go</button>
    </div>

    <div class="col-md-3">
        <button style="margin-top: 24px" type="button" class="btn btn-default" data-bind="click: function() { reloadSearchPage('Sites') }">Show all</button>
    </div>

</div>
<hr />
@if (Model != null)
{
    <div class="row">
        <div class="col-md-1">
            <strong>Highlighting:</strong>
        </div>
        <div class="col-md-4">
            <div class="btn-group">
                <button id="btnToggleHighlightTrialPriceSites" type="button" class="btn btn-sm btn-default" data-infotip="Toggle [b]Trial Price[/b] Sites Highlighting"><i class="fa fa-flask"></i> Trial Prices <span class="badge">@(trialPriceSiteCount)</span></button>
                <button id="btnToggleHighlightMatchCompetitors" type="button" class="btn btn-sm btn-default" data-infotip="Toggle [b]Match Competitor[/b] Highlighting"><i class="fa fa-clone"></i> Match Competitors <span class="badge">@(matchCompetitorSiteCount)</span> </button>
                <button id="btnToggleHighlightNonePrices" type="button" class="btn btn-sm btn-default" data-infotip="Toggle [b][/b] Highlighting"><i class="fa fa-minus"></i> None <span class="badge">@(siloSiteCount)</span></button>
            </div>
        </div>

        <div class="col-md-3"></div>


        <div class="col-md-1 text-right">
            <strong>Show:</strong>
        </div>

        <div class="col-md-3 text-right">
            <button id="btnResetActiveSites" type="button" style="display: none;" class="btn btn-sm btn-danger" data-infotip="Show [b]All[/b] the Sites"><i class="fa fa-power-off "></i> Reset</button>
            <div class="btn-group">
                <button id="btnShowActiveSites" type="button" class="btn btn-sm btn-default" data-infotip="Show or Hide the [b]Active[/b] Sites"><i class="fa fa-square"></i> Active <span class="badge">@(activeSiteCount)</span></button>
                <button id="btnShowInActiveSites" type="button" class="btn btn-sm btn-default" data-infotip="Show or Hide the [b]In-active[/b] Sites"><i class="fa fa-square-o"></i> Inactive <span class="badge">@(inactiveSiteCount)</span></button>
            </div>
        </div>
    </div>
    <hr />

    @Html.Partial("_SiteList", Model)
}

<script type="text/javascript">
    require(["SiteMaintenance"],
        function (sitemaintenance) { }
    );
</script>
