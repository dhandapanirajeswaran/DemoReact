@using JsPlc.Ssc.PetrolPricing.Models
@{
    ViewBag.Title = "Site Prices";
}

<h2>Site Prices</h2>

<div class="container" id="petrolpricingpage">
    <!-- knockout binds here -->
    <div id="msgs"></div>
    <!-- Submit disabled, all work done thru ajax calls -->
    <form id="myform" method="post" data-bind="submit: savePetrolPricingForm"
          xclass="input-group-sm" onsubmit="return false;">

        <span>Market Comparison: Sainsburys's prices and Competitors</span>
        <div class="table-responsive">
            <table class="table">
                <!-- HEADINGS -->
                <thead>
                    <!-- 11 column layout -->
                    <tr rowspan="2" style="background-color: silver">
                        <th><span>#</span></th>
                        <th><span>Store No.</span></th>
                        <th><span>Store Name</span></th>
                        <th><span>Cat No.</span></th>
                        <th><span>PFS No.</span></th>

                        <th colspan="2"><span class="fuelHeaderGroup">Unleaded</span></th>
                        <th colspan="2"><span class="fuelHeaderGroup">Diesel</span></th>
                        <th colspan="2"><span class="fuelHeaderGroup">LPG</span></th>
                    </tr>
                    <tr>
                        <th colspan="5"></th>
                        <th><span>Tomorrow</span></th>
                        <th><span>Today</span></th>
                        <th><span>Tomorrow</span></th>
                        <th><span>Today</span></th>
                        <th><span>Tomorrow</span></th>
                        <th><span>Today</span></th>
                    </tr>
                </thead>
                <tbody data-bind="with: dataModel, visible: dataAvailable">
                    <!-- Within a foreach JSStores loop -->
                    <!-- JS Store DataRows -->
                    <tr>
                        <td><span data-bind="text: plusMinusText, click: toggleExpandCollapse" class="expander">+</span></td>
                        <td><span data-bind="text: StoreNo">102</span></td>
                        <td><span data-bind="text: StoreName">Sainsburys Hendon</span></td>
                        <td><span data-bind="text: CatNo"></span>100</td>
                        <td><span data-bind="text: PFSNo"></span>99</td>

                        <td>
                            <span data-bind="text: FuelPriceTomorrowAutoCalc">107.9</span>
                            <input type="text" data-bind="value: FuelPriceTomorrowOverridden" class="txtPrice" />
                        </td>
                        <td><span data-bind="text: FuelPriceToday">108.9</span></td>
                        <td>
                            <span data-bind="text: FuelPriceTomorrowAutoCalc">107.9</span>
                            <input type="text" data-bind="value: FuelPriceTomorrowOverridden" class="txtPrice" />
                        </td>
                        <td><span data-bind="text: FuelPriceToday">108.9</span></td>
                        <td>
                            <span data-bind="text: FuelPriceTomorrowAutoCalc">107.9</span>
                            <input type="text" data-bind="value: FuelPriceTomorrowOverridden" class="txtPrice" />
                        </td>
                        <td><span data-bind="text: FuelPriceToday">108.9</span></td>
                    </tr>
                    <tr class="competitors" id="competitorsForSite102" style="visibility: xhidden; display: xnone">
                        <td colspan="11">
                            <!-- Competitors table -->
                            <table class="competitorTable" data-bind="visible: toggleCompetitors">
                                <thead>
                                    <tr rowspan="2">
                                        <th><span>Brand</span></th>
                                        <th><span>Marker</span></th>
                                        <th><span>Drive-Time</span></th>
                                        <th><span>Cat No.</span></th>

                                        <th colspan="2"><span class="fuelHeaderGroup">Unleaded</></span></th>
                                        <th colspan="2"><span class="fuelHeaderGroup">Diesel</span></th>
                                        <th colspan="2"><span class="fuelHeaderGroup">LPG</span></th>
                                    </tr>
                                    <tr>
                                        <th colspan="4"></th>
                                        <th><span>Today</span></th>
                                        <th><span>Yesterday</span></th>
                                        <th><span>Today</span></th>
                                        <th><span>Yesterday</span></th>
                                        <th><span>Today</span></th>
                                        <th><span>Yesterday</span></th>
                                    </tr>
                                    <tr>
                                        <th colspan="10">
                                            <hr class="styleFour" />
                                        </th>
                                    </tr>
                                </thead>
                                <tbody data-bind="with: competitors, visible: hasCompetitors">
                                    <!-- Within a foreach CompStores loop -->
                                    <!-- Comp Store DataRows -->
                                    <tr>
                                        <td><span data-bind="text: Brand">Asda</span></td>
                                        <td><span data-bind="text: CompetitorStoreName">Asda Compton</span></td>
                                        <td><span data-bind="text: DriveTime"></span>2.45min</td>
                                        <td><span data-bind="text: CatNo"></span>1336</td>

                                        <td><span data-bind="text: FuelPriceToday">107.9</span></td>
                                        <td><span data-bind="text: FuelPriceYesterday">109.9</span></td>

                                        <td><span data-bind="text: FuelPriceToday">106.9</span></td>
                                        <td><span data-bind="text: FuelPriceYesterday">108.9</span></td>

                                        <td><span data-bind="text: FuelPriceToday">106.9</span></td>
                                        <td><span data-bind="text: FuelPriceYesterday">108.9</span></td>
                                    </tr>
                                    <tr>
                                        <td><span data-bind="text: Brand">Tesco</span></td>
                                        <td><span data-bind="text: CompetitorStoreName">Tesco Green Park</span></td>
                                        <td><span data-bind="text: DriveTime"></span>4.10min</td>
                                        <td><span data-bind="text: CatNo"></span>1336</td>

                                        <td><span data-bind="text: FuelPriceToday">107.9</span></td>
                                        <td><span data-bind="text: FuelPriceYesterday">109.9</span></td>

                                        <td><span data-bind="text: FuelPriceToday">106.9</span></td>
                                        <td><span data-bind="text: FuelPriceYesterday">108.9</span></td>

                                        <td><span data-bind="text: FuelPriceToday">106.9</span></td>
                                        <td><span data-bind="text: FuelPriceYesterday">108.9</span></td>
                                    </tr>
                                </tbody>
                                <tbody data-bind="visible: false" style="visibility: hidden; display: none">
                                    <tr>
                                        <td colspan="10" class="noSiteData">Sorry, no site data available</td>
                                    </tr>
                                </tbody>
                                <tbody>
                                    <tr>
                                        <td colspan="10">
                                            <hr class="styleFour" />
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                    </tr>

                    <!-- Next site TODO Remove this once knockout foreach is in place -->
                    <tr>
                        <td><span data-bind="text: plusMinusText, click: toggleExpandCollapse" class="expander">+</span></td>
                        <td><span data-bind="text: StoreNo">202</span></td>
                        <td><span data-bind="text: StoreName">Sainsburys Hendon</span></td>
                        <td><span data-bind="text: CatNo"></span>200</td>
                        <td><span data-bind="text: PFSNo"></span>199</td>

                        <td>
                            <span data-bind="text: FuelPriceTomorrowAutoCalc">107.9</span>
                            <input type="text" data-bind="value: FuelPriceTomorrowOverridden" class="txtPrice" />
                        </td>
                        <td><span data-bind="text: FuelPriceToday">108.9</span></td>
                        <td>
                            <span data-bind="text: FuelPriceTomorrowAutoCalc">107.9</span>
                            <input type="text" data-bind="value: FuelPriceTomorrowOverridden" class="txtPrice" />
                        </td>
                        <td><span data-bind="text: FuelPriceToday">108.9</span></td>
                        <td>
                            <span data-bind="text: FuelPriceTomorrowAutoCalc">107.9</span>
                            <input type="text" data-bind="value: FuelPriceTomorrowOverridden" class="txtPrice" />
                        </td>
                        <td><span data-bind="text: FuelPriceToday">108.9</span></td>
                    </tr>
                    <tr class="competitors" id="competitorsforsite202" style="visibility: hidden; display: none">
                        <td colspan="11">
                            <!-- Competitors table -->
                            <table class="table" xstyle="visibility: hidden; display: none" data-bind="visible: toggleCompetitors">
                                <thead>
                                    <tr rowspan="2">
                                        <th><span>Brand</span></th>
                                        <th><span>Marker</span></th>
                                        <th><span>Drive-Time</span></th>
                                        <th><span>Cat No.</span></th>

                                        <th colspan="2"><span>Unleaded</span></th>
                                        <th colspan="2"><span>Diesel</span></th>
                                        <th colspan="2"><span>LPG</span></th>
                                    </tr>
                                    <tr>
                                        <th colspan="4"></th>
                                        <th><span>Today</span></th>
                                        <th><span>Yesterday</span></th>
                                        <th><span>Today</span></th>
                                        <th><span>Yesterday</span></th>
                                        <th><span>Today</span></th>
                                        <th><span>Yesterday</span></th>
                                    </tr>
                                </thead>
                                <tbody data-bind="with: competitors, visible: hasCompetitors">
                                    <!-- Within a foreach CompStores loop -->
                                    <!-- Comp Store DataRows -->
                                    <tr>
                                        <td><span data-bind="text: Brand">Asda</span></td>
                                        <td><span data-bind="text: CompetitorStoreName">Asda Compton</span></td>
                                        <td><span data-bind="text: DriveTime"></span>2.45min</td>
                                        <td><span data-bind="text: CatNo"></span>1336</td>

                                        <td><span data-bind="text: FuelPriceToday">106.9</span></td>
                                        <td><span data-bind="text: FuelPriceYesterday">108.9</span></td>

                                        <td><span data-bind="text: FuelPriceToday">106.9</span></td>
                                        <td><span data-bind="text: FuelPriceYesterday">108.9</span></td>

                                        <td><span data-bind="text: FuelPriceToday">106.9</span></td>
                                        <td><span data-bind="text: FuelPriceYesterday">108.9</span></td>
                                    </tr>
                                    <tr>
                                        <td><span data-bind="text: Brand">Tesco</span></td>
                                        <td><span data-bind="text: CompetitorStoreName">Tesco Green Park</span></td>
                                        <td><span data-bind="text: DriveTime"></span>4.10min</td>
                                        <td><span data-bind="text: CatNo"></span>1336</td>

                                        <td><span data-bind="text: FuelPriceToday">107.9</span></td>
                                        <td><span data-bind="text: FuelPriceYesterday">109.9</span></td>

                                        <td><span data-bind="text: FuelPriceToday">106.9</span></td>
                                        <td><span data-bind="text: FuelPriceYesterday">108.9</span></td>

                                        <td><span data-bind="text: FuelPriceToday">106.9</span></td>
                                        <td><span data-bind="text: FuelPriceYesterday">108.9</span></td>
                                    </tr>
                                </tbody>
                                <tbody data-bind="visible: !hasCompetitors">
                                    <tr>
                                        <td colspan="10" class="noSiteData">Sorry, no site data available</td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                    </tr>

                </tbody>
                <tbody data-bind="visible: !dataAvailable" style="visibility: hidden; display: none">
                    <tr>
                        <td colspan="10" class="noSiteData">Sorry, no site data available</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </form>
</div>

<br />

<script type="text/javascript">
    require(["SitePricing"]); // TODO Uncomment to fireup calls to get/send data
</script>

