@using System.Configuration;
<!DOCTYPE html>
<html lang="en-gb">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="@(Request.ApplicationPath == "/" ? "/" : Request.ApplicationPath + "/")">
    <link rel="shortcut icon icon" type="image/ico" href="favicon.ico" />
    <title>@ViewBag.Title - Petrol Pricing</title>
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    <script type="text/javascript" src="~/Scripts/require.js"></script>
    <script type="text/javascript" src="~/Scripts/require.config.js"></script>
    <script type="text/javascript">
        require(["PetrolPricingService"], function (PetrolPricingService) {
            PetrolPricingService.setServiceBaseUrl("@(ConfigurationManager.AppSettings["ServicesBaseUrl"])");
        });
    </script>
    <meta name="description" content="Petrol pricing application for responding to market prices" />
    @RenderSection("head", false)
</head>
<body>
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" rel="home" href="/" title="Sainsbury's Petrol Pricing">
                    <img title="Sainsbury's Petrol Pricing" src="@Url.Content("~/images/logo.png")" />
                    Petrol Pricing
                </a>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li data-menu-item="nav-home">@Html.ActionLink("Home", "Index", "Home")</li>

                    @Html.Partial("_NavLinks")

                    <li data-menu-item="nav-contact">@Html.ActionLink("Contact", "Contact", "Home")</li>
                    
                    @Html.Partial("_LoginPartial")
                </ul>
            </div>
        </div>
    </div>
    <div class="container body-content">
        @RenderBody()
    </div>

    <div class="panel-footer" style="margin-top: 100px">
        <div class="container">
            <footer>
                <p>&copy; @DateTime.Today.Year - Sainsbury's Petrol Pricing</p>
            </footer>
        </div>
    </div>
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)
    <script type="text/javascript">
        require(['bootstrap'], function () {

            //navigation
            $(".navbar-nav li").removeClass("active");

            var navItemAttributeName = "data-menu-item";
            $(".navbar-nav li").each(function () {
                $this = $(this);
                var locationPath = location.pathname.toLowerCase();
                
                // ignore dev URL
                locationPath = locationPath.replace(/^\/petrolpricing\//i, '/');
                
                //nav-home // /
                if (locationPath == '/'
                    && $this.attr(navItemAttributeName) == "nav-home")
                {
                    $this.addClass("active");
                    return false;
                }
                //nav-login // /Account/Login
                else if (locationPath.indexOf("/account/login") == 0
                    && $this.attr(navItemAttributeName) == "nav-login") {
                    $this.addClass("active");
                    return false;
                }
                //nav-account // /Manage || /Account
                else if ((locationPath.indexOf("/account") == 0
                    || location.pathname.indexOf("/Manage") == 0
                    )
                    && $this.attr(navItemAttributeName) == "nav-account") {
                    $this.addClass("active");
                    return false;
                }
                //nav-about // /Home/About
                else if (locationPath.indexOf("/home/about") == 0
                    && $this.attr(navItemAttributeName) == "nav-about") {
                    $this.addClass("active");
                    return false;
                }
                //nav-contact // /Home/Contact
                else if (locationPath.indexOf("/home/contact") == 0
                    && $this.attr(navItemAttributeName) == "nav-contact") {
                    $this.addClass("active");
                    return false;
                }
                //nav-upload // /File
                else if (locationPath.indexOf("/file") == 0
                    && $this.attr(navItemAttributeName) == "nav-upload") {
                    $this.addClass("active");
                    return false;
                }
                //nav-site-pricing // /Sites/Prices
                else if (locationPath.indexOf("/sites/prices") == 0
                    && $this.attr(navItemAttributeName) == "nav-site-pricing") {
                    $this.addClass("active");
                    return false;
                }
                //nav-site-maintenance // /Sites
                else if (locationPath.indexOf("/sites") == 0
                    && $this.attr(navItemAttributeName) == "nav-site-maintenance") {
                    $this.addClass("active");
                    return false;
                }
                //nav-reports // /PriceReports
                else if (locationPath.indexOf("/pricereports") == 0
                    && $this.attr(navItemAttributeName) == "nav-reports") {
                    $this.addClass("active");
                    return false;
                }
            });
        });
    </script>

</body>
</html>
